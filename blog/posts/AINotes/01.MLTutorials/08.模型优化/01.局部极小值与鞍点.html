<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled</title>
    <meta name="description" content="Untitled - Hongwei Zhao's Blog">
    <meta name="author" content="Hongwei Zhao">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Code Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" id="hljs-theme-dark">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" id="hljs-theme-light" disabled>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- KaTeX for Math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <style>
        :root {
            /* Light Theme - 明亮清新配色 */
            --primary-color: #4A90D9;
            --primary-hover: #3678C2;
            --link-color: #E86B5F;
            --text-color: #2D2D2D;
            --text-light: #5A5A5A;
            --text-muted: #8A8A8A;
            --bg-color: #FFFFFF;
            --bg-secondary: #F5F7FA;
            --bg-code: #F8F9FC;
            --border-color: #E8ECF0;
            --shadow: 0 2px 8px rgba(0,0,0,0.06);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.08);
        }

        [data-theme="dark"] {
            --primary-color: #5dade2;
            --primary-hover: #85c1e9;
            --link-color: #e74c3c;
            --text-color: #e5e7eb;
            --text-light: #9ca3af;
            --text-muted: #6b7280;
            --bg-color: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-code: #0f0f23;
            --border-color: #374151;
            --shadow: 0 1px 3px rgba(0,0,0,0.3);
            --shadow-lg: 0 4px 15px rgba(0,0,0,0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 16px;
            line-height: 1.8;
            color: var(--text-color);
            background: var(--bg-color);
            transition: background-color 0.3s, color 0.3s;
        }

        a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--primary-hover);
            text-decoration: underline;
        }

        /* Layout */
        .page-wrapper {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            gap: 3rem;
        }

        /* Sidebar TOC */
        .toc-sidebar {
            width: 260px;
            flex-shrink: 0;
            position: sticky;
            top: 2rem;
            height: fit-content;
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
        }

        .toc-container {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .toc-container h3 {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toc-container ul {
            list-style: none;
        }

        .toc-container li {
            margin-bottom: 0.5rem;
        }

        .toc-container a {
            font-size: 0.9rem;
            color: var(--text-light);
            display: block;
            padding: 0.25rem 0;
            border-left: 2px solid transparent;
            padding-left: 0.75rem;
            transition: all 0.2s;
        }

        .toc-container a:hover,
        .toc-container a.active {
            color: var(--primary-color);
            border-left-color: var(--primary-color);
            text-decoration: none;
        }

        .toc-container ul ul {
            margin-left: 1rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            min-width: 0;
            max-width: 800px;
        }

        /* Header */
        .post-header {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 1.5rem;
        }

        .back-link:hover {
            color: var(--primary-color);
            text-decoration: none;
        }

        .post-header h1 {
            font-size: 2.25rem;
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: 1rem;
            color: var(--text-color);
        }

        .post-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .post-meta span {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .post-meta i {
            color: var(--text-muted);
        }

        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .tag {
            display: inline-block;
            font-size: 0.8rem;
            background: var(--bg-secondary);
            color: var(--text-light);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }

        .tag:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Article Content */
        .post-content {
            font-size: 1rem;
            line-height: 1.9;
        }

        .post-content h1,
        .post-content h2,
        .post-content h3,
        .post-content h4,
        .post-content h5,
        .post-content h6 {
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
            line-height: 1.4;
            color: var(--text-color);
        }

        .post-content h1 { font-size: 1.875rem; }
        .post-content h2 { 
            font-size: 1.5rem; 
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .post-content h3 { font-size: 1.25rem; }
        .post-content h4 { font-size: 1.125rem; }

        .post-content p {
            margin-bottom: 1.25rem;
        }

        .post-content ul,
        .post-content ol {
            margin: 1.25rem 0;
            padding-left: 1.5rem;
        }

        .post-content li {
            margin-bottom: 0.5rem;
        }

        .post-content blockquote {
            margin: 1.5rem 0;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-left: 4px solid var(--primary-color);
            border-radius: 0 8px 8px 0;
            color: var(--text-light);
            font-style: italic;
        }

        .post-content blockquote p:last-child {
            margin-bottom: 0;
        }

        /* Code */
        .post-content code {
            font-family: 'JetBrains Mono', 'Fira Code', Consolas, monospace;
            font-size: 0.9em;
            background: var(--bg-code);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            color: var(--link-color);
        }

        .post-content pre {
            margin: 1.5rem 0;
            padding: 1.25rem;
            background: var(--bg-code);
            border-radius: 10px;
            overflow-x: auto;
            border: 1px solid var(--border-color);
        }

        .post-content pre code {
            background: none;
            padding: 0;
            color: inherit;
            font-size: 0.875rem;
            line-height: 1.6;
        }

        /* Images */
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-lg);
        }

        /* Tables */
        .post-content table {
            width: 100%;
            margin: 1.5rem 0;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        .post-content th,
        .post-content td {
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            text-align: left;
        }

        .post-content th {
            background: var(--bg-secondary);
            font-weight: 600;
        }

        .post-content tr:nth-child(even) {
            background: var(--bg-secondary);
        }

        /* Math */
        .math-display {
            margin: 1.5rem 0;
            overflow-x: auto;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        /* Anchor links */
        .anchor-link {
            opacity: 0;
            margin-left: 0.5rem;
            color: var(--text-muted);
            font-weight: 400;
            transition: opacity 0.2s;
        }

        .post-content h2:hover .anchor-link,
        .post-content h3:hover .anchor-link,
        .post-content h4:hover .anchor-link {
            opacity: 1;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            box-shadow: var(--shadow-lg);
            transition: transform 0.2s, background 0.2s;
            z-index: 1000;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            background: var(--primary-hover);
        }

        /* Comments Section */
        .comments-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
        }

        .comments-section h3 {
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Footer */
        .post-footer {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .toc-sidebar {
                display: none;
            }
            
            .page-wrapper {
                padding: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .post-header h1 {
                font-size: 1.75rem;
            }
            
            .post-meta {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .theme-toggle {
                bottom: 1rem;
                right: 1rem;
                width: 44px;
                height: 44px;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <!-- TOC Sidebar -->
        <aside class="toc-sidebar">
            <div class="toc-container">
                <h3><i class="fas fa-list"></i> 目录</h3>
                <div class="toc">
<ul>
<li><a href="#局部极小值与鞍点">局部极小值与鞍点</a><ul>
<li><a href="#临界点及其种类">临界点及其种类</a></li>
<li><a href="#判断临界值种类的方法">判断临界值种类的方法</a></li>
</ul>
</li>
</ul>
</div>

            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <article>
                <header class="post-header">
                    <a href="../../../../index.html" class="back-link">
                        <i class="fas fa-arrow-left"></i> 返回博客列表
                    </a>
                    <h1>Untitled</h1>
                    <div class="post-meta">
                        <span><i class="fas fa-calendar-alt"></i> 2026-02-04</span>
                        <span><i class="fas fa-folder"></i> AINotes/01.MLTutorials/08.模型优化</span>
                        <span><i class="fas fa-user"></i> Hongwei Zhao</span>
                    </div>
                    <div class="tags">
                        
                    </div>
                </header>

                <div class="post-content">
                    <p><strong>临界点</strong>：<br />
<strong>局部极小值</strong> ：<br />
<strong>鞍点</strong>：</p>
<h2 id="局部极小值与鞍点">局部极小值与鞍点<a class="anchor-link" href="#局部极小值与鞍点" title="Permanent link">&para;</a></h2>
<p>我们在做优化的时候经常会发现，随着参数不断更新，训练的损失不会再下降, 但是我们对这个损失仍然不满意。把深层网络（deep network）、线性模型和浅层网络（shallow network）做比较，可以发现深层网络没有做得更好——深层网络没有发挥出它完整的力量，所以优化是有问题的。但有时候，模型一开始就训练不起来，不管我们怎么更新参数，损失都降不下去。这个时候到底发生了什么事情？</p>
<h3 id="临界点及其种类">临界点及其种类<a class="anchor-link" href="#临界点及其种类" title="Permanent link">&para;</a></h3>
<p>过去常见的一个猜想是我们优化到某个地方，这个地方损失关于参数的微分为零，如图所示。图中的两条曲线对应两个神经网络训练的过程。当损失关于参数的微分为零的时候，梯度下降就不能再更新参数了，训练就停下来了，损失不再下降了。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/202409131656532.png"/></div>

<p>提到梯度为零的时候，大家最先想到的可能就是局部极小值（local minimum），如图 3.2a 所示。所以经常有人说，做深度学习时使用梯度下降会收敛在局部极小值，梯度下降不起作用。但其实损失不是只在局部极小值的梯度是零，还有其他可能会让梯度是零的点，比如鞍点（saddle point）。鞍点其实就是梯度是零且区别于局部极小值和局部极大值（local maximum）的点。图 3.2b 红色的点在 <span class="math-inline">y</span> 轴方向是比较高的，在 <span class="math-inline">x</span> 轴方向是比较低的，这就是一个鞍点。鞍点的叫法是因为其形状像马鞍。鞍点的梯度为零，但它不是局部极小值。我们把梯度为零的点统称为临界点（critical point）。损失没有办法再下降，也许是因为收敛在了临界点，但不一定收敛在局部极小值，因为鞍点也是梯度为零的点。</p>
<p>但是如果一个点的梯度真的很接近零，我们走到临界点的时候，这个临界点到底是局部极小值还是鞍点，是一个值得去探讨的问题。因为如果损失收敛在局部极小值，我们所在的位置已经是损失最低的点了，往四周走损失都会比较高，就没有路可以走了。但鞍点没有这个问题，旁边还是有路可以让损失更低的。只要逃离鞍点，就有可能让损失更低。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/20241010093221.png" style="zoom: 60%;" /></div>

<h3 id="判断临界值种类的方法">判断临界值种类的方法<a class="anchor-link" href="#判断临界值种类的方法" title="Permanent link">&para;</a></h3>
<p>判断一个临界点到底是局部极小值还是鞍点需要知道损失函数的形状。可是怎么知道损失函数的形状？网络本身很复杂，用复杂网络算出来的损失函数显然也很复杂。虽然无法完整知道整个损失函数的样子，但是如果给定某一组参数，比如 <span class="math-inline">\theta^{\prime}</span>，在 <span class="math-inline">\theta^{\prime}</span> 附近的损失函数是有办法写出来的——虽然 <span class="math-inline">L(\theta)</span> 完整的样子写不出来。<span class="math-inline">\theta^{\prime}</span> 附近的 <span class="math-inline">L(\theta)</span> 可近似为</p>
<p><div class="math-display"><br />
L(\theta)\approx L\left(\theta^{\prime}\right)+\left(\theta-\theta^{\prime}\right)^{T} g+\frac{1}{2}\left(\theta-\theta^{\prime}\right)^{T} H\left(\theta-\theta^{\prime}\right).\qquad(3.1)<br />
</div><br />
式(3.1)是泰勒级数近似(Tayler series approximation)。<br />
- 第一项 <span class="math-inline">L(\theta^{\prime})</span> 告诉我们，当 <span class="math-inline">\theta</span> 跟 <span class="math-inline">\theta^{\prime}</span> 很近的时候，<span class="math-inline">L(\theta)</span> 应该跟 <span class="math-inline">L\left(\theta^{\prime}\right)</span> 还蛮靠近的；<br />
- 第二项 <span class="math-inline">\left(\theta-\theta^{\prime}\right)^{T} g</span> 中，<span class="math-inline">g</span> 代表梯度，它是一个向量，可以弥补 <span class="math-inline">L\left(\theta^{\prime}\right)</span> 跟 <span class="math-inline">L(\theta)</span> 之间的差距。有时候梯度 <span class="math-inline">g</span> 会写成 <span class="math-inline">\nabla L\left(\theta^{\prime}\right)</span>。<span class="math-inline">g_i</span> 是向量 <span class="math-inline">g</span> 的第 <span class="math-inline">i</span> 元素，就是 <span class="math-inline">L</span> 于 <span class="math-inline">\theta</span> 的第 <span class="math-inline">i</span> 元素的偏导数，即</p>
<p><div class="math-display"><br />
g_i=\frac{\partial L\left(\theta^{\prime}\right)}{\partial\theta_i}.\qquad(3.2)<br />
</div></p>
<ul>
<li>光看 <span class="math-inline">g</span> 还是没有办法完整地描述 <span class="math-inline">L(\theta)</span>，还要看式(3.1)的第三项 <span class="math-inline">\frac{1}{2}\left(\theta-\theta^{\prime}\right)^{T} H\left(\theta-\theta^{\prime}\right)</span>。第三项跟海森矩阵(Hessian matrix) <span class="math-inline">H</span> 关。<span class="math-inline">H</span> 面放的是 <span class="math-inline">L</span> 的二次微分，它第 <span class="math-inline">i</span> ，第 <span class="math-inline">j</span> 的值 <span class="math-inline">H_{i j}</span> 就是把 <span class="math-inline">\theta</span> 的第 <span class="math-inline">i</span> 个元素对 <span class="math-inline">L\left(\theta^{\prime}\right)</span> 作微分，再把 <span class="math-inline">\theta</span> 的第 <span class="math-inline">j</span> 元素对 <span class="math-inline">\frac{\partial L\left(\theta^{\prime}\right)}{\partial\theta_i}</span> 作微分后的结果，即</li>
</ul>
<p><div class="math-display"><br />
H_{i j}=\frac{\partial^2}{\partial\theta_i\partial\theta_j} L\left(\theta^{\prime}\right).\qquad(3.3)<br />
</div></p>
<p>总结一下，损失函数 <span class="math-inline">L(\theta)</span> 在 <span class="math-inline">\theta^{\prime}</span> 附近可近似为式(3.1)，式(3.1)跟梯度和海森矩阵有关，梯度就是一次微分，海森矩阵里面有二次微分的项。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/20241010101048.png" style="zoom: 60%;" /></div>

<p>在临界点，梯度<span class="math-inline">g</span> 零，因此 <span class="math-inline">\left(\theta-\theta^{\prime}\right)^{T} g</span> 为零。所以在临界点的附近，损失函数可被近似为</p>
<p><div class="math-display"> L(\theta)\approx L\left(\theta^{\prime}\right)+\frac{1}{2}\left(\theta-\theta^{\prime}\right)^{T} H\left(\theta-\theta^{\prime}\right);\quad(3.4) </div></p>
<p>我们可以根据 <span class="math-inline">\frac{1}{2}\left(\theta-\theta^{\prime}\right)^{T} H\left(\theta-\theta^{\prime}\right)</span> 来判断在 <span class="math-inline">\theta^{\prime}</span> 附近的误差表面(error surface)到底长什么样子。知道误差表面的“地貌”，我们就可以判断 <span class="math-inline">L\left(\theta^{\prime}\right)</span> 是局部极小值、局部极大值，还是鞍点。为了符号简洁，我们用向量 <span class="math-inline">v</span> 表示 <span class="math-inline">\theta-\theta^{\prime},\left(\theta-\theta^{\prime}\right)^{T} H\left(\theta-\theta^{\prime}\right)</span> 可改写为 <span class="math-inline">v^{T} H v</span>，有如下三种情况。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/20241010101300.png" style="zoom: 60%;" /></div>

<p>(1) 如果对所有 <span class="math-inline">v, v^{T} H v&gt;0</span>。这意味着对任意 <span class="math-inline">\theta, L(\theta)&gt;L\left(\theta^{\prime}\right)</span>。只要 <span class="math-inline">\theta</span> 在 <span class="math-inline">\theta^{\prime}</span> 附近，<span class="math-inline">L(\theta)</span> 都大于 <span class="math-inline">L\left(\theta^{\prime}\right)</span>。这代表 <span class="math-inline">L\left(\theta^{\prime}\right)</span> 是附近的一个最低点，所以它是局部极小值。</p>
<p>(2) 如果对所有 <span class="math-inline">v, v^{T} H v&lt;0</span>。这意味着对任意 <span class="math-inline">\theta, L(\theta)&lt;L\left(\theta^{\prime}\right)</span>，<span class="math-inline">\theta^{\prime}</span> 是附近最高的一个点，<span class="math-inline">L\left(\theta^{\prime}\right)</span> 是局部极大值。</p>
<p>(3) 如果对于 <span class="math-inline">v, v^{T} H v</span> 有时候大于零，有时候小于零。这意味着在 <span class="math-inline">\theta^{\prime}</span> 附近，有时候 <span class="math-inline">L(\theta)&gt;L\left(\theta^{\prime}\right)</span>，有时候 <span class="math-inline">L(\theta)&lt;L\left(\theta^{\prime}\right)</span>。因此在 <span class="math-inline">\theta^{\prime}</span> 附近，<span class="math-inline">L\left(\theta^{\prime}\right)</span> 既不是局部极大值，也不是局部极小值，而是鞍点。</p>
<p>有一个问题，通过 <span class="math-inline">\frac{1}{2}\left(\theta-\theta^{\prime}\right)^{T} H\left(\theta-\theta^{\prime}\right)</span> 判断临界点是局部极小值还是鞍点还是局部极大值，需要代入所有的 <span class="math-inline">\theta</span>。但我们不可能把所有的 <span class="math-inline">v</span> 拿来试试看，所以有一个更简便的方法来判断 <span class="math-inline">v^{T} H v</span> 的正负。算出一个海森矩阵后，不需要把它跟所有的 <span class="math-inline">v</span> 都乘乘看，只要看 <span class="math-inline">H</span> 特征值。若 <span class="math-inline">H</span> 所有特征值都是正的，<span class="math-inline">H</span> 正定矩阵，则 <span class="math-inline">v^{T} H v&gt;0</span>，临界点是局部极小值。若 <span class="math-inline">H</span> 所有特征值都是负的，<span class="math-inline">H</span> 负定矩阵，则 <span class="math-inline">v^{T} H v&lt;0</span>，临界点是局部极大值。若<span class="math-inline">H</span> 特征值有正有负，临界点是鞍点。</p>
<blockquote>
<p>如果 <span class="math-inline">n</span> 对称矩阵 <span class="math-inline">A</span> 于任意非零的 <span class="math-inline">n</span> 向量 <span class="math-inline">x</span> 都有 <span class="math-inline">x^{T} A x&gt;0</span>，则称矩阵 <span class="math-inline">A</span> 为正定矩阵。如果 <span class="math-inline">n</span> 对称矩阵 <span class="math-inline">A</span> 对于任意非零的 <span class="math-inline">n</span> 向量 <span class="math-inline">x</span> 都有 <span class="math-inline">x^{T} A x&lt;0</span>，则称矩阵<span class="math-inline">A</span> 负定矩阵。</p>
</blockquote>
<p>举个例子，我们有一个简单的神经网络，它只有两个神经元，而且这个神经元还没有激活函数和偏置。输入 <span class="math-inline">x</span>，<span class="math-inline">x</span> 上 <span class="math-inline">w_1</span> 以后输出，然后再乘上 <span class="math-inline">w_2</span>，接着再输出，最终得到的数据就是 <span class="math-inline">y</span>。<br />
<div class="math-display"><br />
y=w_1 w_2 x.\qquad(3.5)<br />
</div><br />
我们还有一个简单的训练数据集，这个数据集只有一组数据(1,1)，也就是 <span class="math-inline">x=1</span> 的标签是 1。所以输入 1进去，我们希望最终的输出跟 1越接近越好，如图 3.3所示。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/20241010102438.png" style="zoom: 60%;" /></div>

<p>可以直接画出这个神经网络的误差表面，如图 3.4所示，可以取[-2,2]之间的 <span class="math-inline">w_1</span> 跟 <span class="math-inline">w_2</span> 的数值，算出这个范围内 <span class="math-inline">w_1, w_2</span> 数值所带来的损失，四个角落的损失是高的。我们用黑色的点来表示临界点，原点(0,0)是临界点，另外两排点是临界点。我们可以进一步地判断这些临界点是鞍点还是局部极小值。原点是鞍点，因为我们往某个方向走，损失可能会变大，也可能会变小。而另外两排临界点都是局部极小值。这是我们取[-2,2]之间的参数得到的损失函数以后，得到的损失的值后，画出误差表面后得到的结论。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/20241010102453.png" style="zoom: 60%;" /></div>

<p>除了尝试取所有可能的损失，我们还有其他的方法，比如把损失的函数写出来。对于图 3.3所示的神经网络，损失函数 <span class="math-inline">L</span> 正确答案 <span class="math-inline">y</span> 掉模型的输出 <span class="math-inline">\hat{y}=w_1 w_2 x</span> 后取平方误差(square error)，这里只有一组数据，因此不会对所有的训练数据进行加和。令 <span class="math-inline">x=1, y=1</span>，损失函数为</p>
<p><div class="math-display"> L=\left(y-w_1 w_2 x\right)^2=\left(1-w_1 w_2\right)^2.\qquad(3.6) </div></p>
<p>可以求出损失函数的梯度 <span class="math-inline">g=\left[\frac{\partial L}{\partial w_1},\frac{\partial L}{\partial w_2}\right]</span>：</p>
<p><div class="math-display"><br />
\begin{cases}<br />
\frac{\partial L}{\partial w_1} &amp;= 2\left(1-w_1 w_2\right)\left(-w_2\right); \<br />
\frac{\partial L}{\partial w_2} &amp;= 2\left(1-w_1 w_2\right)\left(-w_1\right).<br />
\end{cases}<br />
\qquad(3.7)<br />
</div></p>
<p>什么时候梯度会为零（也就是到一个临界点）呢？比如，在原点时，<span class="math-inline">w_1=0, w_2=0</span>，此时的梯度为零，原点就是一个临界点，但通过海森矩阵才能判断它是哪种临界点。刚才我们通过取[-2,2]之间的 <span class="math-inline">w_1</span> 和 <span class="math-inline">w_2</span> 来判断出原点是一个鞍点，但是假设我们还没有取所有可能的损失，我们要看看能不能够用海森矩阵来判断原点是什么临界点。</p>
<p>海森矩阵<span class="math-inline">H</span> 集了<span class="math-inline">L</span> 二次微分：</p>
<p><div class="math-display"><br />
\left{<br />
\begin{align<em>}<br />
H_{1,1} &amp;= \frac{\partial^2 L}{\partial w_1^2} = 2\left(-w_2\right)\left(-w_2\right) \<br />
H_{1,2} &amp;= \frac{\partial^2 L}{\partial w_1\partial w_2} = -2 + 4 w_1 w_2 \<br />
H_{2,1} &amp;= \frac{\partial^2 L}{\partial w_2\partial w_1} = -2 + 4 w_1 w_2 \<br />
H_{2,2} &amp;= \frac{\partial^2 L}{\partial w_2^2} = 2\left(-w_1\right)\left(-w_1\right)<br />
\end{align</em>}<br />
\right.<br />
</div></p>
<p>对于原点，只要把 <span class="math-inline">w_1=0, w_2=0</span> 代进去，有海森矩阵</p>
<p><div class="math-display"><br />
H=\left[\begin{array}{rr}<br />
0 &amp; -2 \<br />
-2 &amp; 0<br />
\end{array}\right].<br />
\qquad(3.9)<br />
</div></p>
<p>通过海森矩阵来判断原点是局部极小值还是鞍点，要看它的特征值，这个矩阵有两个特征值：2和-2，特征值有正有负，因此原点是鞍点。</p>
<p>如果我们当前处于鞍点，就不用那么害怕了。<span class="math-inline">H</span> 只可以帮助我们判断是不是在一个鞍点，还指出了参数可以更新的方向。之前我们参数更新的时候，都是看梯度 <span class="math-inline">g</span>，但是我们走到某个地方以后发现 <span class="math-inline">g</span> 成 0了，就不能再看 <span class="math-inline">g</span> ，<span class="math-inline">g</span> 见了。但如果临界点是一个鞍点，还可以再看 <span class="math-inline">H</span>，怎么再看 <span class="math-inline">H</span> ，<span class="math-inline">H</span> 么告诉我们怎么更新参数呢？</p>
<p>设 <span class="math-inline">\lambda</span> 为 <span class="math-inline">H</span> 一个特征值 <span class="math-inline">\lambda</span>，<span class="math-inline">u</span> 为其对应的特征向量。对于我们的优化问题，可令 <span class="math-inline">u=\theta-\theta^{\prime}</span>，则</p>
<p><div class="math-display"><br />
u^{T} H u = u^{T}(\lambda u) = \lambda|u|^2.<br />
\qquad(3.10)<br />
</div></p>
<p>若 <span class="math-inline">\lambda&lt;0</span>，则 <span class="math-inline">\lambda|u|^2&lt;0</span>。所以 <span class="math-inline">\frac{1}{2}\left(\theta-\theta^{\prime}\right)^{T} H\left(\theta-\theta^{\prime}\right)&lt;0</span>。此时，<span class="math-inline">L(\theta)&lt;L\left(\theta^{\prime}\right)</span>，且</p>
<p><div class="math-display"><br />
\theta = \theta^{\prime} + u\text{.}<br />
\qquad(3.11)<br />
</div></p>
<p>沿着 <span class="math-inline">u</span> 方向更新 <span class="math-inline">\theta</span>，损失就会变小。因为根据式(3.10)和式(3.11)，只要 <span class="math-inline">\theta=\theta^{\prime}+u</span>，沿着特征向量 <span class="math-inline">u</span> 方向去更新参数，损失就会变小，所以虽然临界点的梯度为零，如果我们是在一个鞍点，只要找出负的特征值，再找出这个特征值对应的特征向量。将其与 <span class="math-inline">\theta^{\prime}</span> 相加，就可以找到一个损失更低的点。</p>
<p>在前面的例子中，原点是一个临界点，此时的海森矩阵如式(3.9)所示，该海森矩阵有一个负的特征值：-2，特征值-2对应的特征向量有无穷多个。不妨取 <span class="math-inline">u=[1,1]^{ T}</span>，作为-2对应的特征向量。我们其实只要顺着u的方向去更新参数，就可以找到一个比鞍点的损失还要更低的点。以这个例子来看，原点是鞍点，其梯度为零，所以梯度不会告诉我们要怎么更新参数。但海森矩阵的特征向量告诉我们只要往 <span class="math-inline">[1,1]^{\text{T}}</span> 的方向更新。损失就会变得更小，就可以逃离鞍点。</p>
<p>所以从这个角度来看，鞍点似乎并没有那么可怕。但实际上，我们几乎不会真的把海森矩阵算出来，因为海森矩阵需要算二次微分，计算这个矩阵的运算量非常大，还要把它的特征值跟特征向量找出来，所以几乎没有人用这个方法来逃离鞍点。还有一些其他逃离鞍点的方法的运算量都比要算海森矩阵小很多。</p>
<p><div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/20241010104210.png" style="zoom: 60%;" /></div></p>
<p>如图 3.5(a)所示的一维空间中的误差表面，有一个局部极小值。但是在二维空间（如图3.5(b)所示），这个点就可能只是一个鞍点。常常会有人画类似图3.5(c)这样的图来告诉我们深度学习的训练是非常复杂的。如果我们移动某两个参数，误差表面的变化非常的复杂，有非常多局部极小值。低维度空间中的局部极小值点，在更高维的空间中，实际是鞍点。同样地，如果在二维的空间中没有路可以走，会不会在更高维的空间中，其实有路可以走？更高的维度难以视化它，但我们在训练一个网络的时候，参数数量动辄达百万千万级，所以误差表面其实有非常高的维度参数的数量代表了误差表面的维度。既然维度这么高，会不会其实就有非常多的路可以走呢？既然有非常多的路可以走，会不会其实局部极小值就很少呢？而经验上，我们如果自己做一些实验，会发现实际情况也支持这个假说。图3.6是训练某不同神经网络的结果，每个点对应一个神经网络。纵轴代表训练网络时，损失收敛到临界点，损失没法下降时的损失。我们常常会遇到两种情况：损失仍然很高，却遇到了临界点而不再下降；或者损失降得很低，才遇到临界点。图 3.6中，横轴代表最小值比例（minimum ratio），最小值比例定义为</p>
<p><div class="math-display"><br />
\text{最小值比例} = \frac{\text{正特征值数量}}{\text{总特征值数量}}.<br />
\qquad(3.12)<br />
</div></p>
<p>实际上，我们几乎找不到所有特征值都为正的临界点。在图 3.6所示的例子中，最小值比例最大也不过处于 <span class="math-inline">0.5\sim 0.6</span> 的范围，代表只有约一半的特征值为正，另一半的特征值为负，代表在所有的维度里面有约一半的路可以让损失上升，还有约一半的路可以让损失下降。虽然在这个图上，越靠近右侧代表临界点“看起来越像”局部极小值，但是这些点都不是真正的局部极小值。所以从经验上看起来，局部极小值并没有那么常见。多数的时候，我们训练到一个梯度很小的地方，参数不再更新，往往只是遇到了鞍点。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/20241010104224.png" style="zoom: 60%;" /></div>
                </div>

                <!-- Comments Section (Giscus) -->
                <section class="comments-section">
                    <h3><i class="fas fa-comments"></i> 评论</h3>
                    <script src="https://giscus.app/client.js"
                        data-repo="Geeks-Z/Geeks-Z.github.io"
                        data-repo-id=""
                        data-category="Announcements"
                        data-category-id=""
                        data-mapping="pathname"
                        data-strict="0"
                        data-reactions-enabled="1"
                        data-emit-metadata="0"
                        data-input-position="bottom"
                        data-theme="preferred_color_scheme"
                        data-lang="zh-CN"
                        crossorigin="anonymous"
                        async>
                    </script>
                </section>
            </article>

            <footer class="post-footer">
                <p>© 2025 Hongwei Zhao. Built with ❤️</p>
            </footer>
        </main>
    </div>

    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
        <i class="fas fa-moon"></i>
    </button>

    <script>
        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        const icon = themeToggle.querySelector('i');
        const hljsDark = document.getElementById('hljs-theme-dark');
        const hljsLight = document.getElementById('hljs-theme-light');
        
        // Check saved theme or system preference
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
            html.setAttribute('data-theme', 'dark');
            icon.className = 'fas fa-sun';
            hljsDark.disabled = false;
            hljsLight.disabled = true;
        }
        
        themeToggle.addEventListener('click', () => {
            const isDark = html.getAttribute('data-theme') === 'dark';
            if (isDark) {
                html.removeAttribute('data-theme');
                icon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'light');
                hljsDark.disabled = true;
                hljsLight.disabled = false;
            } else {
                html.setAttribute('data-theme', 'dark');
                icon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'dark');
                hljsDark.disabled = false;
                hljsLight.disabled = true;
            }
            
            // Update Giscus theme
            const giscusFrame = document.querySelector('iframe.giscus-frame');
            if (giscusFrame) {
                giscusFrame.contentWindow.postMessage({
                    giscus: {
                        setConfig: {
                            theme: isDark ? 'light' : 'dark'
                        }
                    }
                }, 'https://giscus.app');
            }
        });
        
        // Highlight.js
        document.addEventListener('DOMContentLoaded', () => {
            hljs.highlightAll();
        });
        
        // KaTeX auto-render
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof renderMathInElement !== 'undefined') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\[', right: '\\]', display: true},
                        {left: '\\(', right: '\\)', display: false}
                    ],
                    throwOnError: false
                });
            }
        });
        
        // TOC active state
        const tocLinks = document.querySelectorAll('.toc-container a');
        const headings = document.querySelectorAll('.post-content h2, .post-content h3, .post-content h4');
        
        function updateTocActive() {
            let current = '';
            headings.forEach(heading => {
                const rect = heading.getBoundingClientRect();
                if (rect.top <= 100) {
                    current = heading.getAttribute('id');
                }
            });
            
            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        }
        
        window.addEventListener('scroll', updateTocActive);
        updateTocActive();
    </script>
</body>
</html>
