<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled</title>
    <meta name="description" content="Untitled - Hongwei Zhao's Blog">
    <meta name="author" content="Hongwei Zhao">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Code Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" id="hljs-theme-dark">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" id="hljs-theme-light" disabled>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- KaTeX for Math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <style>
        :root {
            /* Light Theme */
            --primary-color: #2980b9;
            --primary-hover: #1a5276;
            --link-color: #c0392b;
            --text-color: #333;
            --text-light: #666;
            --text-muted: #999;
            --bg-color: #fff;
            --bg-secondary: #f8f9fa;
            --bg-code: #f5f5f5;
            --border-color: #e5e7eb;
            --shadow: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-lg: 0 4px 15px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --primary-color: #5dade2;
            --primary-hover: #85c1e9;
            --link-color: #e74c3c;
            --text-color: #e5e7eb;
            --text-light: #9ca3af;
            --text-muted: #6b7280;
            --bg-color: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-code: #0f0f23;
            --border-color: #374151;
            --shadow: 0 1px 3px rgba(0,0,0,0.3);
            --shadow-lg: 0 4px 15px rgba(0,0,0,0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 16px;
            line-height: 1.8;
            color: var(--text-color);
            background: var(--bg-color);
            transition: background-color 0.3s, color 0.3s;
        }

        a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--primary-hover);
            text-decoration: underline;
        }

        /* Layout */
        .page-wrapper {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            gap: 3rem;
        }

        /* Sidebar TOC */
        .toc-sidebar {
            width: 260px;
            flex-shrink: 0;
            position: sticky;
            top: 2rem;
            height: fit-content;
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
        }

        .toc-container {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .toc-container h3 {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toc-container ul {
            list-style: none;
        }

        .toc-container li {
            margin-bottom: 0.5rem;
        }

        .toc-container a {
            font-size: 0.9rem;
            color: var(--text-light);
            display: block;
            padding: 0.25rem 0;
            border-left: 2px solid transparent;
            padding-left: 0.75rem;
            transition: all 0.2s;
        }

        .toc-container a:hover,
        .toc-container a.active {
            color: var(--primary-color);
            border-left-color: var(--primary-color);
            text-decoration: none;
        }

        .toc-container ul ul {
            margin-left: 1rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            min-width: 0;
            max-width: 800px;
        }

        /* Header */
        .post-header {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 1.5rem;
        }

        .back-link:hover {
            color: var(--primary-color);
            text-decoration: none;
        }

        .post-header h1 {
            font-size: 2.25rem;
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: 1rem;
            color: var(--text-color);
        }

        .post-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .post-meta span {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .post-meta i {
            color: var(--text-muted);
        }

        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .tag {
            display: inline-block;
            font-size: 0.8rem;
            background: var(--bg-secondary);
            color: var(--text-light);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }

        .tag:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Article Content */
        .post-content {
            font-size: 1rem;
            line-height: 1.9;
        }

        .post-content h1,
        .post-content h2,
        .post-content h3,
        .post-content h4,
        .post-content h5,
        .post-content h6 {
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
            line-height: 1.4;
            color: var(--text-color);
        }

        .post-content h1 { font-size: 1.875rem; }
        .post-content h2 { 
            font-size: 1.5rem; 
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .post-content h3 { font-size: 1.25rem; }
        .post-content h4 { font-size: 1.125rem; }

        .post-content p {
            margin-bottom: 1.25rem;
        }

        .post-content ul,
        .post-content ol {
            margin: 1.25rem 0;
            padding-left: 1.5rem;
        }

        .post-content li {
            margin-bottom: 0.5rem;
        }

        .post-content blockquote {
            margin: 1.5rem 0;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-left: 4px solid var(--primary-color);
            border-radius: 0 8px 8px 0;
            color: var(--text-light);
            font-style: italic;
        }

        .post-content blockquote p:last-child {
            margin-bottom: 0;
        }

        /* Code */
        .post-content code {
            font-family: 'JetBrains Mono', 'Fira Code', Consolas, monospace;
            font-size: 0.9em;
            background: var(--bg-code);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            color: var(--link-color);
        }

        .post-content pre {
            margin: 1.5rem 0;
            padding: 1.25rem;
            background: var(--bg-code);
            border-radius: 10px;
            overflow-x: auto;
            border: 1px solid var(--border-color);
        }

        .post-content pre code {
            background: none;
            padding: 0;
            color: inherit;
            font-size: 0.875rem;
            line-height: 1.6;
        }

        /* Images */
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-lg);
        }

        /* Tables */
        .post-content table {
            width: 100%;
            margin: 1.5rem 0;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        .post-content th,
        .post-content td {
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            text-align: left;
        }

        .post-content th {
            background: var(--bg-secondary);
            font-weight: 600;
        }

        .post-content tr:nth-child(even) {
            background: var(--bg-secondary);
        }

        /* Math */
        .math-display {
            margin: 1.5rem 0;
            overflow-x: auto;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        /* Anchor links */
        .anchor-link {
            opacity: 0;
            margin-left: 0.5rem;
            color: var(--text-muted);
            font-weight: 400;
            transition: opacity 0.2s;
        }

        .post-content h2:hover .anchor-link,
        .post-content h3:hover .anchor-link,
        .post-content h4:hover .anchor-link {
            opacity: 1;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            box-shadow: var(--shadow-lg);
            transition: transform 0.2s, background 0.2s;
            z-index: 1000;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            background: var(--primary-hover);
        }

        /* Comments Section */
        .comments-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
        }

        .comments-section h3 {
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Footer */
        .post-footer {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .toc-sidebar {
                display: none;
            }
            
            .page-wrapper {
                padding: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .post-header h1 {
                font-size: 1.75rem;
            }
            
            .post-meta {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .theme-toggle {
                bottom: 1rem;
                right: 1rem;
                width: 44px;
                height: 44px;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <!-- TOC Sidebar -->
        <aside class="toc-sidebar">
            <div class="toc-container">
                <h3><i class="fas fa-list"></i> 目录</h3>
                <div class="toc">
<ul>
<li><a href="#sophisticated-input">Sophisticated Input</a></li>
<li><a href="#vector-set-as-input">Vector Set as Input</a></li>
<li><a href="#what-is-the-output">What is the output?</a></li>
<li><a href="#sequence-labeling">Sequence Labeling</a></li>
</ul>
</div>

            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <article>
                <header class="post-header">
                    <a href="../../../index.html" class="back-link">
                        <i class="fas fa-arrow-left"></i> 返回博客列表
                    </a>
                    <h1>Untitled</h1>
                    <div class="post-meta">
                        <span><i class="fas fa-calendar-alt"></i> 2026-01-28</span>
                        <span><i class="fas fa-folder"></i> AINotes/04.Transformer</span>
                        <span><i class="fas fa-user"></i> Hongwei Zhao</span>
                    </div>
                    <div class="tags">
                        
                    </div>
                </header>

                <div class="post-content">
                    <blockquote>
<p><a href="https://hw-universal.oss-cn-beijing.aliyuncs.com/self_v7.pptx">self_v7.pptx</a></p>
</blockquote>
<h2 id="sophisticated-input">Sophisticated Input<a class="anchor-link" href="#sophisticated-input" title="Permanent link">&para;</a></h2>
<p>到目前为止，Network的<strong>Input</strong>都是<strong>一个向量</strong>，然后我们的输出，可能是一个<strong>数值</strong>，这个是<strong>Regression</strong>，可能是一个<strong>类别</strong>，这是<strong>Classification</strong>。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002129.png" alt="image-20210403221220604" style="zoom: 67%;" /></div>

<p>但假设我们遇到更复杂的问题呢，假设我们说<strong>输入是多个向量</strong>，而且这个<strong>输入的向量的数目是会改变的</strong>呢?</p>
<h2 id="vector-set-as-input">Vector Set as Input<a class="anchor-link" href="#vector-set-as-input" title="Permanent link">&para;</a></h2>
<ul>
<li>文字处理</li>
</ul>
<p>假设我们今天Network的输入是一个句子，每一个句子的长度都不一样，每个句子里面词汇的数目都不一样</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002353.png" alt="image-20210403221757797" style="zoom: 150%;" /></div>

<p>如果我们把一个<strong>句子里面的每一个词汇，都描述成一个向量</strong>，那我们的Model的<strong>输入</strong>，就会<strong>是一个Vector Set</strong>，而且这个Vector Set的大小，每次都不一样，句子的长度不一样，那你的Vector Set的大小就不一样。</p>
<p>那<strong>怎么把一个词汇表示成一个向量</strong>，最简单的做法是<strong>One-Hot的Encoding</strong></p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002859.png" alt="image-20210403222112679" style="zoom: 150%;" /></div>

<p>你就开一个很长很长的向量，这个向量的长度跟世界上存在的词汇的数目是一样多的，每一个维度对应到一个词汇，Apple就是100，Bag就是010，Cat就是001，以此类推。</p>
<p>但是这样子的表示方法有一个非常严重的问题，它假设所有的<strong>词汇彼此之间都是没有关系</strong>的，从这个向量里面你看不到：Cat跟Dog都是动物所以他们比较接近，Cat跟Apple一个动物一个植物，所以他们比较不相像。这个向量里面，没有任何语义的资讯。</p>
<p>有另外一个方法叫做<strong>Word Embedding</strong></p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002145.png" alt="image-20210403222544230" style="zoom: 150%;" /></div>

<p>Word Embedding就是，我们会给每一个词汇一个向量，而这个<strong>向量是有语义的资讯的</strong>，一个句子就是一排长度不一的向量。</p>
<p>如果你把Word Embedding画出来的话，你会发现，所有的动物可能聚集成一团，所有的植物可能聚集成一团，所有的动词可能聚集成一团等等。</p>
<p>其他的 Vector Set 实例：</p>
<ul>
<li>声音信号</li>
</ul>
<p>一小段25个Millisecond里面的语音讯号，为了要描述一整段的声音讯号，你会把这个<strong>Window往右移一点</strong>，通常移动的大小是10个Millisecond，所以一秒钟的声音讯号有100个向量，所以一分钟的声音讯号，就有这个100乘以60，就有6000个向量。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002990.png" alt="image-20210404161620047" style="zoom:50%;" /></div>

<ul>
<li>图</li>
</ul>
<p>​   一个Graph 一个图，也是一堆向量，我们知道说Social Network就是一个Graph</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002840.png" alt="image-20210404161854708" style="zoom:50%;" /></div>

<ul>
<li>分子信息</li>
</ul>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002341.png" alt="image-20210404162239665" style="zoom:50%;" /></div>

<h2 id="what-is-the-output">What is the output?<a class="anchor-link" href="#what-is-the-output" title="Permanent link">&para;</a></h2>
<p>我们刚才已经看说输入是一堆向量，它可以是文字，可以是语音，可以是Graph，那这个时候，我们有可能有什么样的输出呢，有三种可能性</p>
<ol>
<li>每一个向量都有一个对应的Label</li>
</ol>
<p>当你的模型，看到输入是四个向量的时候，它就要输出四个Label，而每一个Label，它可能是一个数值，那就是Regression的问题，如果每个Label是一个Class，那就是一个Classification的问题</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002809.png" alt="image-20210404165717142" style="zoom:50%;" /></div>

<ul>
<li>
<p>举例来说 在文字处理上，假设你今天要做的是<strong>POS Tagging</strong>，POS Tagging就是词性标注，你要让机器自动决定每一个词汇它是什么样的词性，它是名词、还是动词、还是形容词等等。举例来说，你现在看到一个句子，“I saw a saw”，这并不是打错，并不是“我看一个看”，而是“我看到一个锯子”，这个第二个saw当名词用的时候，它是锯子，那所以机器要知道，第一个saw是个动词，第二个saw虽然它也是个saw，但它是名词，但是每一个输入的词汇，都要有一个对应的输出的词性，这个任务就是，输入跟输出的长度是一样的Case，这个就是属于第一个类型的输出。</p>
</li>
<li>
<p>那如果是语音的话，你可以想想看我们作业二就是这样子的任务。虽然我们作业二，没有给大家一个完整的Sequence，我们是把每一个Vector分开给大家了，但是串起来就是一段声音讯号里面，有一串Vector，每一个Vector你都要决定，它是哪一个Phonetic，这是一个语音辨识的简化版。</p>
</li>
<li>
<p>或者是如果是Social Network的话，就是给一个Graph，你的Model要决定每一个节点，它有什么样的特性，比如说他会不会买某一个商品，这样我们才知道说，要不要推荐某一个商品给他，所以以上就是举输入跟输出数目一样的例子</p>
</li>
</ul>
<ol start="2">
<li>一整个Sequence，只需要输出一个Label</li>
</ol>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002311.png" alt="image-20210404165454032" style="zoom:50%;" /></div>

<ul>
<li>
<p>举例来说，如果是文字的话，我们就说Sentiment Analysis。Sentiment Analysis就是给机器看一段话，它要<strong>决定说这段话是正面的还是负面的</strong>，那你可以想像说这种应用很有用，假设你的公司开发了一个产品，这个产品上线了，你想要知道网友的评价怎么样，但是你又不可能一则一则网友的留言都去分析，那也许你就可以用这种，Sentiment Analysis的技术，让机器自动去判读说，当一则贴文里面有提到某个产品的时候，它是正面的 还是负面的，那你就可以知道你的产品，在网友心中的评价怎么样，这个是Sentiment Analysis给一整个句子，只需要一个Label，那Positive或Negative，那这个就是第二类的输出</p>
</li>
<li>
<p>那如果是语音的例子的话呢，在作业四里面我们会做语者辨认，机器要听一段声音，然后决定他是谁讲的</p>
</li>
<li>或者是如果是Graph的话呢，今天你可能想要给一个分子，然后要预测说这个分子，比如说它有没有毒性，或者是它的亲水性如何，那这就是给一个Graph 输出一个Label</li>
</ul>
<ol start="3">
<li>机器要自己决定，应该要输出多少个Label</li>
</ol>
<p>我们不知道应该输出多少个Label，机器要自己决定，应该要输出多少个Label，可能你输入是N个向量，输出可能是N'个Label，为什么是N'，机器自己决定</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002762.png" alt="image-20210404170045293" style="zoom: 50%; " /></div>

<p>​      这种任务又叫做<strong>sequence to sequence</strong>的任务，那我们在作业五会有sequence to sequence的作业，所以这个之后我们还会再讲</p>
<ul>
<li>翻译就是sequence to sequence的任务，因为输入输出是不同的语言，它们的词汇的数目本来就不会一样多</li>
<li>或者是语音辨识也是，真正的语音辨识也是一个sequence to sequence的任务，输入一句话，然后输出一段文字，这也是一个sequence to sequence的任务</li>
</ul>
<h2 id="sequence-labeling">Sequence Labeling<a class="anchor-link" href="#sequence-labeling" title="Permanent link">&para;</a></h2>
<p>那这种输入跟输出数目一样多的状况又叫做<strong>Sequence Labeling</strong>，你要给Sequence里面的每一个向量，都给它一个Label，那要怎么解Sequence Labeling的问题呢</p>
<p>那直觉的想法就是我们就拿个<strong>Fully-Connected的Network</strong></p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002082.png" alt="image-20210404172216111" style="zoom: 50%;" /></div>

<p>然后虽然这个输入是一个Sequence，但我们就各个击破，不要管它是不是一个Sequence，把每一个向量，分别输入到Fully-Connected的Network里面，然后Fully-Connected的Network就会给我们输出，那现在看看，你要做的是Regression还是Classification，产生正确的对应的输出，就结束了。</p>
<p>那这么做显然有<strong>非常大的瑕疵</strong>，假设今天是，词性标记的问题，你给机器一个句子，I saw a saw，对Fully-Connected Network来说，<strong>后面这一个saw跟前面这个saw完全一模一样</strong>，它们是同一个词汇啊，既然Fully-Connected的Network<strong>输入同一个词汇，它没有理由输出不同的东西</strong>，但实际上，你期待第一个saw要输出动词，第二个saw要输出名词，但对Network来说它不可能做到，因为这两个saw 明明是一模一样的，你叫它一个要输出动词，一个要输出名词，它会非常地困惑，完全不知道要怎么处理。所以怎么办，有没有可能<strong>让Fully-Connected的Network，考虑更多的，比如说上下文的Context的资讯</strong>呢</p>
<p>这是有可能的，你就<strong>把前后几个向量都串起来，一起丢到Fully-Connected的Network就结束了</strong></p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002508.png" alt="image-20210404172839097" style="zoom: 50%;" /></div>

<p>在作业二里面，我们不是只看一个Frame，去判断这个Frame属于哪一个Phonetic，也就属于哪一个音标，而是看这个Frame的前面五个加后面五个，也就总共看十一个Frame，来决定它是哪一个音标</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002926.png" alt="image-20210404173219186" style="zoom: 50%;" /></div>

<p>所以我们可以给Fully-Connected的Network，一整个Window的资讯，让它可以考虑一些上下文的，跟我现在要考虑的这个向量，相邻的其他向量的资讯，但是<strong>这样子的方法还是有极限</strong>，作业二就算是给你Sequence的资讯，你考虑整个Sequence，你可能也很难再做的更好啦，作业二考虑前后五个Frame，其实就可以得到很不错的结果了，所以你要过Strong Baseline，重点并不在于考虑整个Sequence，你就不需要往那个方向想了，用助教现有给你的Data，你就可以轻易的过Strong Baseline，</p>
<p>但是真正的问题，如果今天我们有某一个任务，不是考虑一个Window就可以解决的，而是要<strong>考虑一整个Sequence才能够解决</strong>的话，那要怎么办呢</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002430.png" alt="image-20210404173257899" style="zoom:50%;" /></div>

<p>那有人可能会想说这个很容易，我就<strong>把Window开大一点啊，大到可以把整个Sequence盖住就结束了</strong></p>
<p>但是，今天<strong>Sequence的长度是有长有短的</strong>，我们刚才有说，我们输入给我们的Model的Sequence的长度，每次可能都不一样</p>
<p>如果你今天说我真的要开一个Window，把整个Sequence盖住，那你可能要<strong>统计一下你的训练资料</strong>，然后看看你的训练资料里面，最长的Sequence有多长，然后开一个Window比最长的Sequence还要长，你才有可能把整个Sequence盖住</p>
<p>但是你开一个这么大的Window，意味著说你的Fully-Connected的Network，它需要非常多的参数，那可能不只<strong>运算量很大，可能还容易Overfitting</strong></p>
<p>所以有没有更好的方法，来考虑整个Input Sequence的资讯呢，这就要用到我们接下来要跟大家介绍的，<strong>Self-Attention</strong>这个技术。</p>
<p>Self-Attention的运作方式就是，<strong>Self-Attention会吃一整个Sequence的资讯</strong>。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002952.png" alt="image-20210404174805338" style="zoom: 50%; text-align:center;" /></div>

<p>然后你Input几个Vector，它就输出几个Vector，比如说你这边Input一个深蓝色的Vector，这边就给你一个另外一个Vector，这边给个浅蓝色，它就给你另外一个Vector，这边输入4个Vector，它就Output 4个Vector，这4个Vector，他们都是考虑一整个Sequence以后才得到的，所以上方每一个向量，我们特别给它一个黑色的框框代表说它不是一个普通的向量。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002501.png" alt="image-20210404193106925" style="zoom: 50%;" /></div>

<p>如此一来你这个Fully-Connected的Network，它就不是只考虑一个非常小的范围，或一个小的Window，而是考虑整个Sequence的资讯，再来决定现在应该要输出什么样的结果，这个就是<strong>Self-Attention</strong>。</p>
<p><strong>Self-Attention不是只能用一次，你可以叠加很多次</strong>。</p>
<div align=center><img src="https://markdownimg-hw.oss-cn-beijing.aliyuncs.com/image202208161002158.png" alt="image-20210404194146583" style="zoom: 50%;" /></div>

<p>可以Self-Attention的输出，通过Fully-Connected Network以后，再做一次Self-Attention，Fully-Connected的Network，再过一次Self-Attention，再重新考虑一次整个Input Sequence的资讯，再丢到另外一个Fully-Connected的Network，最后再得到最终的结果。</p>
<p>所以<strong>可以把Fully-Connected的Network，跟Self-Attention交替使用</strong></p>
<ul>
<li>Self-Attention处理整个Sequence的资讯</li>
<li>Fully-Connected的Network，专注于处理某一个位置的资讯</li>
<li>再用Self-Attention，再把整个Sequence资讯再处理一次</li>
<li>然后交替使用Self-Attention跟Fully-Connected</li>
</ul>
<p>有关Self-Attention，最知名的相关的文章，就是《Attention is all you need》.那在这篇Paper里面呢，Google提出了<strong>Transformer</strong>这样的Network架构。</p>
                </div>

                <!-- Comments Section (Giscus) -->
                <section class="comments-section">
                    <h3><i class="fas fa-comments"></i> 评论</h3>
                    <script src="https://giscus.app/client.js"
                        data-repo="Geeks-Z/Geeks-Z.github.io"
                        data-repo-id=""
                        data-category="Announcements"
                        data-category-id=""
                        data-mapping="pathname"
                        data-strict="0"
                        data-reactions-enabled="1"
                        data-emit-metadata="0"
                        data-input-position="bottom"
                        data-theme="preferred_color_scheme"
                        data-lang="zh-CN"
                        crossorigin="anonymous"
                        async>
                    </script>
                </section>
            </article>

            <footer class="post-footer">
                <p>© 2025 Hongwei Zhao. Built with ❤️</p>
            </footer>
        </main>
    </div>

    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
        <i class="fas fa-moon"></i>
    </button>

    <script>
        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        const icon = themeToggle.querySelector('i');
        const hljsDark = document.getElementById('hljs-theme-dark');
        const hljsLight = document.getElementById('hljs-theme-light');
        
        // Check saved theme or system preference
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
            html.setAttribute('data-theme', 'dark');
            icon.className = 'fas fa-sun';
            hljsDark.disabled = false;
            hljsLight.disabled = true;
        }
        
        themeToggle.addEventListener('click', () => {
            const isDark = html.getAttribute('data-theme') === 'dark';
            if (isDark) {
                html.removeAttribute('data-theme');
                icon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'light');
                hljsDark.disabled = true;
                hljsLight.disabled = false;
            } else {
                html.setAttribute('data-theme', 'dark');
                icon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'dark');
                hljsDark.disabled = false;
                hljsLight.disabled = true;
            }
            
            // Update Giscus theme
            const giscusFrame = document.querySelector('iframe.giscus-frame');
            if (giscusFrame) {
                giscusFrame.contentWindow.postMessage({
                    giscus: {
                        setConfig: {
                            theme: isDark ? 'light' : 'dark'
                        }
                    }
                }, 'https://giscus.app');
            }
        });
        
        // Highlight.js
        document.addEventListener('DOMContentLoaded', () => {
            hljs.highlightAll();
        });
        
        // KaTeX auto-render
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof renderMathInElement !== 'undefined') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\[', right: '\\]', display: true},
                        {left: '\\(', right: '\\)', display: false}
                    ],
                    throwOnError: false
                });
            }
        });
        
        // TOC active state
        const tocLinks = document.querySelectorAll('.toc-container a');
        const headings = document.querySelectorAll('.post-content h2, .post-content h3, .post-content h4');
        
        function updateTocActive() {
            let current = '';
            headings.forEach(heading => {
                const rect = heading.getBoundingClientRect();
                if (rect.top <= 100) {
                    current = heading.getAttribute('id');
                }
            });
            
            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        }
        
        window.addEventListener('scroll', updateTocActive);
        updateTocActive();
    </script>
</body>
</html>
