<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tensor([[ 1, 20],</title>
    <meta name="description" content="tensor([[ 1, 20], - Hongwei Zhao's Blog">
    <meta name="author" content="Hongwei Zhao">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Code Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" id="hljs-theme-dark">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" id="hljs-theme-light" disabled>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- KaTeX for Math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <style>
        :root {
            /* Light Theme */
            --primary-color: #2980b9;
            --primary-hover: #1a5276;
            --link-color: #c0392b;
            --text-color: #333;
            --text-light: #666;
            --text-muted: #999;
            --bg-color: #fff;
            --bg-secondary: #f8f9fa;
            --bg-code: #f5f5f5;
            --border-color: #e5e7eb;
            --shadow: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-lg: 0 4px 15px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --primary-color: #5dade2;
            --primary-hover: #85c1e9;
            --link-color: #e74c3c;
            --text-color: #e5e7eb;
            --text-light: #9ca3af;
            --text-muted: #6b7280;
            --bg-color: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-code: #0f0f23;
            --border-color: #374151;
            --shadow: 0 1px 3px rgba(0,0,0,0.3);
            --shadow-lg: 0 4px 15px rgba(0,0,0,0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', 'Noto Sans SC', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 16px;
            line-height: 1.8;
            color: var(--text-color);
            background: var(--bg-color);
            transition: background-color 0.3s, color 0.3s;
        }

        a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--primary-hover);
            text-decoration: underline;
        }

        /* Layout */
        .page-wrapper {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            gap: 3rem;
        }

        /* Sidebar TOC */
        .toc-sidebar {
            width: 260px;
            flex-shrink: 0;
            position: sticky;
            top: 2rem;
            height: fit-content;
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
        }

        .toc-container {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .toc-container h3 {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toc-container ul {
            list-style: none;
        }

        .toc-container li {
            margin-bottom: 0.5rem;
        }

        .toc-container a {
            font-size: 0.9rem;
            color: var(--text-light);
            display: block;
            padding: 0.25rem 0;
            border-left: 2px solid transparent;
            padding-left: 0.75rem;
            transition: all 0.2s;
        }

        .toc-container a:hover,
        .toc-container a.active {
            color: var(--primary-color);
            border-left-color: var(--primary-color);
            text-decoration: none;
        }

        .toc-container ul ul {
            margin-left: 1rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            min-width: 0;
            max-width: 800px;
        }

        /* Header */
        .post-header {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 1.5rem;
        }

        .back-link:hover {
            color: var(--primary-color);
            text-decoration: none;
        }

        .post-header h1 {
            font-size: 2.25rem;
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: 1rem;
            color: var(--text-color);
        }

        .post-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .post-meta span {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .post-meta i {
            color: var(--text-muted);
        }

        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .tag {
            display: inline-block;
            font-size: 0.8rem;
            background: var(--bg-secondary);
            color: var(--text-light);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }

        .tag:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Article Content */
        .post-content {
            font-size: 1rem;
            line-height: 1.9;
        }

        .post-content h1,
        .post-content h2,
        .post-content h3,
        .post-content h4,
        .post-content h5,
        .post-content h6 {
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
            line-height: 1.4;
            color: var(--text-color);
        }

        .post-content h1 { font-size: 1.875rem; }
        .post-content h2 { 
            font-size: 1.5rem; 
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .post-content h3 { font-size: 1.25rem; }
        .post-content h4 { font-size: 1.125rem; }

        .post-content p {
            margin-bottom: 1.25rem;
        }

        .post-content ul,
        .post-content ol {
            margin: 1.25rem 0;
            padding-left: 1.5rem;
        }

        .post-content li {
            margin-bottom: 0.5rem;
        }

        .post-content blockquote {
            margin: 1.5rem 0;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-left: 4px solid var(--primary-color);
            border-radius: 0 8px 8px 0;
            color: var(--text-light);
            font-style: italic;
        }

        .post-content blockquote p:last-child {
            margin-bottom: 0;
        }

        /* Code */
        .post-content code {
            font-family: 'JetBrains Mono', 'Fira Code', Consolas, monospace;
            font-size: 0.9em;
            background: var(--bg-code);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            color: var(--link-color);
        }

        .post-content pre {
            margin: 1.5rem 0;
            padding: 1.25rem;
            background: var(--bg-code);
            border-radius: 10px;
            overflow-x: auto;
            border: 1px solid var(--border-color);
        }

        .post-content pre code {
            background: none;
            padding: 0;
            color: inherit;
            font-size: 0.875rem;
            line-height: 1.6;
        }

        /* Images */
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-lg);
        }

        /* Tables */
        .post-content table {
            width: 100%;
            margin: 1.5rem 0;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        .post-content th,
        .post-content td {
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            text-align: left;
        }

        .post-content th {
            background: var(--bg-secondary);
            font-weight: 600;
        }

        .post-content tr:nth-child(even) {
            background: var(--bg-secondary);
        }

        /* Math */
        .math-display {
            margin: 1.5rem 0;
            overflow-x: auto;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        /* Anchor links */
        .anchor-link {
            opacity: 0;
            margin-left: 0.5rem;
            color: var(--text-muted);
            font-weight: 400;
            transition: opacity 0.2s;
        }

        .post-content h2:hover .anchor-link,
        .post-content h3:hover .anchor-link,
        .post-content h4:hover .anchor-link {
            opacity: 1;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            box-shadow: var(--shadow-lg);
            transition: transform 0.2s, background 0.2s;
            z-index: 1000;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            background: var(--primary-hover);
        }

        /* Comments Section */
        .comments-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
        }

        .comments-section h3 {
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Footer */
        .post-footer {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .toc-sidebar {
                display: none;
            }
            
            .page-wrapper {
                padding: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .post-header h1 {
                font-size: 1.75rem;
            }
            
            .post-meta {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .theme-toggle {
                bottom: 1rem;
                right: 1rem;
                width: 44px;
                height: 44px;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <!-- TOC Sidebar -->
        <aside class="toc-sidebar">
            <div class="toc-container">
                <h3><i class="fas fa-list"></i> 目录</h3>
                <div class="toc">
<ul>
<li><a href="#torchtopk">torch.topk()</a></li>
<li><a href="#torchunique">torch.unique()</a></li>
<li><a href="#torchnonzero">torch.nonzero</a></li>
<li><a href="#torchwhere">torch.where</a><ul>
<li><a href="#基本语法">基本语法</a></li>
<li><a href="#使用示例">使用示例</a></li>
</ul>
</li>
<li><a href="#scatter">scatter()</a><ul>
<li><a href="#官方示例">官方示例</a></li>
<li><a href="#scatter_">scatter_()</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</li>
</ul>
</div>

            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <article>
                <header class="post-header">
                    <a href="../../../../index.html" class="back-link">
                        <i class="fas fa-arrow-left"></i> 返回博客列表
                    </a>
                    <h1>tensor([[ 1, 20],</h1>
                    <div class="post-meta">
                        <span><i class="fas fa-calendar-alt"></i> 2026-01-28</span>
                        <span><i class="fas fa-folder"></i> AINotes/30.PyTorch/02.Tensors</span>
                        <span><i class="fas fa-user"></i> Hongwei Zhao</span>
                    </div>
                    <div class="tags">
                        
                    </div>
                </header>

                <div class="post-content">
                    <h2 id="torchtopk">torch.topk()<a class="anchor-link" href="#torchtopk" title="Permanent link">&para;</a></h2>
<ol>
<li>作用<br />
   取一个 tensor 的 topk 元素，返回值为降序后的前 k 个大小的元素值及索引</li>
<li>使用方法</li>
</ol>
<ul>
<li>dim=0 表示按照列求 topn</li>
<li>dim=1 表示按照行求 topn</li>
<li>默认情况下，dim=1</li>
</ul>
<ol start="3">
<li>示例</li>
</ol>
<p>```python</p>
<blockquote>
<blockquote>
<blockquote>
<p>x = torch.arange(1., 6.)<br />
x<br />
   tensor([ 1.,  2.,  3.,  4.,  5.])<br />
torch.topk(x, 3)<br />
   torch.return_types.topk(values=tensor([5., 4., 3.]), indices=tensor([4, 3, 2]))<br />
   ```</p>
</blockquote>
</blockquote>
</blockquote>
<hr />
<h2 id="torchunique">torch.unique()<a class="anchor-link" href="#torchunique" title="Permanent link">&para;</a></h2>
<p>torch.unique()的功能类似于数学中的集合，就是挑出 tensor 中的独立不重复元素。</p>
<p>这个方法的参数在官方解释文档中有这么几个:torch.unique(input, sorted=True, return_inverse=False, return_counts=False, dim=None)</p>
<p>input: 待处理的 tensor</p>
<p>sorted：是否对返回的无重复张量按照数值进行排列，默认是生序排列的</p>
<p>return_inverse: 是否返回原始 tensor 中的每个元素在这个无重复张量中的索引</p>
<p>return_counts: 统计原始张量中每个独立元素的个数</p>
<p>dim: 值沿着哪个维度进行 unique 的处理，这个我试验后没有搞懂怎样的机理。如果处理的张量都是一维的，那么这个不需要理会。</p>
<p>下面分别对这些不同的参数进行实验讲解分析。</p>
<pre><code class="language-python">import torch

x = torch.tensor([4,0,1,2,1,2,3])#生成一个tensor,作为实验输入
print(x)

out = torch.unique(x) #所有参数都设置为默认的
print(out)#将处理结果打印出来
#结果如下：
#tensor([0, 1, 2, 3, 4])   #将x中的不重复元素挑了出来，并且默认为生序排列

out = torch.unique(x,sorted=False)#将默认的生序排列改为False
print(out)
#输出结果如下：
#tensor([3, 2, 1, 0, 4])  #将x中的独立元素找了出来，就按照原始顺序输出

out = torch.unique(x,return_inverse=True)#将原始数据中的每个元素在新生成的独立元素张量中的索引输出
print(out)
#输出结果如下：
#(tensor([0, 1, 2, 3, 4]), tensor([4, 0, 1, 2, 1, 2, 3]))  #第一个张量是排序后输出的独立张量，第二个结果对应着原始数据中的每个元素在新的独立无重复张量中的索引，比如x[0]=4,在新的张量中的索引为4, x[1]=0,在新的张量中的索引为0，x[6]=3,在新的张量中的索引为3

out = torch.unique(x,return_counts=True) #返回每个独立元素的个数
print(out)
#输出结果如下
#(tensor([0, 1, 2, 3, 4]), tensor([1, 2, 2, 1, 1]))  #0这个元素在原始数据中的数量为1,1这个元素在原始数据中的数量为2
</code></pre>
<h2 id="torchnonzero">torch.nonzero<a class="anchor-link" href="#torchnonzero" title="Permanent link">&para;</a></h2>
<p><code>torch.nonzero()</code> 是 PyTorch 中的一个函数，用于获取张量中非零元素的索引。这个函数返回一个二维张量，其中每一行都包含输入张量中一个非零元素的索引。</p>
<p>这个函数的语法如下：</p>
<pre><code class="language-python">torch.nonzero(input, *, out=None)
</code></pre>
<p>其中，<code>input</code> 是输入张量。</p>
<p>让我们来看一个例子，假设我们有一个形状为 (3, 3) 的张量 <code>x</code>：</p>
<pre><code class="language-python">import torch

x = torch.tensor([[0, 1, 0], [2, 0, 2], [0, 3, 0]])
print(x)
</code></pre>
<p>现在，我们可以使用 <code>torch.nonzero()</code> 来获取 <code>x</code> 中非零元素的索引：</p>
<pre><code class="language-python">indices = torch.nonzero(x)
print(indices)
</code></pre>
<p>输出结果如下：</p>
<pre><code class="language-python">tensor([[0, 1],
        [1, 0],
        [1, 2],
        [2, 1]])
</code></pre>
<p>可以看到，<code>indices</code> 是一个形状为 (4, 2) 的张量，其中每一行都是 <code>x</code> 中一个非零元素的索引。</p>
<p>需要注意的是，<code>torch.nonzero()</code> 返回的索引是按照行优先顺序排列的，也就是说，它首先返回第一行的非零元素的索引，然后返回第二行的，依此类推。</p>
<p>在 PyTorch 中，<code>scatter()</code> 和 <code>scatter_()</code> 函数通常用于在特定维度上根据索引更新张量（tensor）的值。这两个函数的主要区别在于它们是否原地（in-place）修改输入张量。</p>
<p><code>torch.where</code> 是 PyTorch 中的一个条件选择函数，常用于根据给定条件在两个张量之间进行元素级选择。  </p>
<hr />
<h2 id="torchwhere">torch.where<a class="anchor-link" href="#torchwhere" title="Permanent link">&para;</a></h2>
<h3 id="基本语法">基本语法<a class="anchor-link" href="#基本语法" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">torch.where(condition, x, y)
</code></pre>
<ul>
<li><code>condition</code>：布尔张量，元素值为 <code>True</code> 的位置选择 <code>x</code>，为 <code>False</code> 的位置选择 <code>y</code>。</li>
<li><code>x</code>：当 <code>condition</code> 为 <code>True</code> 时使用的值或张量。</li>
<li><code>y</code>：当 <code>condition</code> 为 <code>False</code> 时使用的值或张量。</li>
</ul>
<h3 id="使用示例">使用示例<a class="anchor-link" href="#使用示例" title="Permanent link">&para;</a></h3>
<p><strong>选择性替换元素</strong></p>
<pre><code class="language-python">import torch

a = torch.tensor([1, 2, 3, 4, 5])
b = torch.tensor([10, 20, 30, 40, 50])
condition = a &gt; 3

result = torch.where(condition, a, b)
print(result)  # tensor([10, 20, 30,  4,  5])
</code></pre>
<ul>
<li><code>a &gt; 3</code> 生成布尔张量 <code>[False, False, False, True, True]</code></li>
<li>只有 <code>a</code> 中大于 3 的元素被保留，其他地方使用 <code>b</code> 的元素。</li>
</ul>
<p><strong>应用于多维张量</strong></p>
<pre><code class="language-python">A = torch.tensor([[1, -2], [3, -4]])
B = torch.tensor([[10, 20], [30, 40]])

condition = A &lt; 0  # 找到负数
result = torch.where(condition, B, A)
print(result)
# tensor([[ 1, 20],
#         [ 3, 40]])
</code></pre>
<ul>
<li>负数用 <code>B</code> 中对应元素替换，其他保持 <code>A</code>。</li>
</ul>
<p><strong>仅提供 <code>condition</code>（索引操作）</strong></p>
<p>如果只提供 <code>condition</code>，<code>torch.where</code> 会返回满足条件的索引。</p>
<pre><code class="language-python">x = torch.tensor([[1, 2, 3], [4, 5, 6]])
indices = torch.where(x &gt; 3)
print(indices)  # (tensor([1, 1, 1]), tensor([0, 1, 2]))
</code></pre>
<ul>
<li><code>indices</code> 代表行索引和列索引，可以用于索引 <code>x[indices]</code>，取出满足条件的元素。</li>
</ul>
<pre><code class="language-python">values = x[indices]
print(values)  # tensor([4, 5, 6])
</code></pre>
<h2 id="scatter">scatter()<a class="anchor-link" href="#scatter" title="Permanent link">&para;</a></h2>
<p><code>scatter()</code> 函数根据提供的索引将源张量的值分散到目标张量中。它不会修改源张量或目标张量本身（即原地操作）。</p>
<p><strong>函数签名</strong>:</p>
<pre><code class="language-python">torch.scatter(input, dim, index, src, *, out=None)
</code></pre>
<ul>
<li><code>input</code> (Tensor): 目标张量。</li>
<li><code>dim</code> (int): 沿其分散的维度。</li>
<li><code>index</code> (LongTensor): 索引张量，其形状必须与 <code>src</code> 的形状在 <code>dim</code> 维度之外的其他所有维度上都匹配。</li>
<li><code>src</code> (Tensor): 源张量，其形状必须与 <code>input</code> 在 <code>dim</code> 维度之外的其他所有维度上都匹配。</li>
<li><code>out</code> (Tensor, optional): 输出张量。</li>
</ul>
<h3 id="官方示例">官方示例<a class="anchor-link" href="#官方示例" title="Permanent link">&para;</a></h3>
<p>三维示例</p>
<pre><code class="language-python">y = y.scatter(dim,index,src)

#则结果为：
y[ index[i][j][k]  ] [j][k] = src[i][j][k] # if dim == 0
y[i] [ index[i][j][k] ] [k] = src[i][j][k] # if dim == 1
y[i][j] [ index[i][j][k] ]  = src[i][j][k] # if dim == 2
</code></pre>
<p>二维示例</p>
<pre><code class="language-python">y = y.scatter(dim,index,src)

#则：
y [ index[i][j] ] [j] = src[i][j] #if dim==0
y[i] [ index[i][j] ]  = src[i][j] #if dim==1
</code></pre>
<pre><code class="language-python">import torch

x = torch.randn(2,4)
print(x)
y = torch.zeros(3,4)
y = y.scatter_(0,torch.LongTensor([[2,1,2,2],[0,2,1,1]]),x)
print(y)


#结果为：
tensor([[-0.9669, -0.4518,  1.7987,  0.1546],
        [-0.1122, -0.7998,  0.6075,  1.0192]])
tensor([[-0.1122,  0.0000,  0.0000,  0.0000],
        [ 0.0000, -0.4518,  0.6075,  1.0192],
        [-0.9669, -0.7998,  1.7987,  0.1546]])


'''
scatter后：
y[ index[0][0] ] [0] = src[0][0] -&gt; y[2][0]=-0.9669
y[ index[1][3] ] [3] = src[1][3] -&gt; y[1][3]=1.10192
'''

#如果src为标量，则代表着将对应位置的数值改为src这个标量
</code></pre>
<p>那么这个函数有什么作用呢？其实可以利用这个功能将 pytorch 中 mini batch 中的返回的 label（特指[ 1,0,4,9 ]，即 size 为[4]这样的 label）转为 one-hot 类型的 label,举例子如下：</p>
<pre><code class="language-python">import torch

mini_batch = 4
out_planes = 6
out_put = torch.rand(mini_batch, out_planes)
softmax = torch.nn.Softmax(dim=1)
out_put = softmax(out_put)

print(out_put)
label = torch.tensor([1,3,3,5])
one_hot_label = torch.zeros(mini_batch, out_planes).scatter_(1,label.unsqueeze(1),1)
print(one_hot_label)
</code></pre>
<p>上述的这个例子假设是一个分类问题，我设置 out_planes=6，是假设总共有 6 类，mini_batch 是我们送入的网络的每个 mini_batch 的样本数量，这里我们不设置网络，直接假设网络的输出为一个随机的张量 ，通常我们要对这个输出进行 softmax 归一化，此时就代表着其属于每个类别的概率了。说到这里都不是重点，就是为了方便理解如何使用 scatter，将 size 为[mini_batch]的张量，转为 size 为[mini_batch, out_palnes]的张量，并且这个生成的张量的每个行向量都是 one-hot 类型的了。通过看下面的输出结果就完全能够理解了。</p>
<pre><code class="language-python">tensor([[0.1202, 0.2120, 0.1252, 0.1127, 0.2314, 0.1985],
        [0.1707, 0.1227, 0.2282, 0.0918, 0.1845, 0.2021],
        [0.1629, 0.1936, 0.1277, 0.1204, 0.1845, 0.2109],
        [0.1226, 0.1524, 0.2315, 0.2027, 0.1907, 0.1001]])
tensor([1, 3, 3, 5])
tensor([[0., 1., 0., 0., 0., 0.],
        [0., 0., 0., 1., 0., 0.],
        [0., 0., 0., 1., 0., 0.],
        [0., 0., 0., 0., 0., 1.]])
</code></pre>
<h3 id="scatter_">scatter_()<a class="anchor-link" href="#scatter_" title="Permanent link">&para;</a></h3>
<p><code>scatter_()</code> 函数与 <code>scatter()</code> 类似，但它会原地修改目标张量（即它会修改 <code>input</code> 张量本身）。</p>
<p><strong>函数签名</strong>:</p>
<pre><code class="language-python">Tensor.scatter_(dim, index, src)
</code></pre>
<ul>
<li><code>dim</code> (int): 沿其分散的维度。</li>
<li><code>index</code> (LongTensor): 索引张量。</li>
<li><code>src</code> (Tensor): 源张量。</li>
</ul>
<h3 id="reference">Reference<a class="anchor-link" href="#reference" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://blog.csdn.net/t20134297/article/details/105755817">pytorch 中的 scatter_()函数使用和详解</a></li>
</ul>
                </div>

                <!-- Comments Section (Giscus) -->
                <section class="comments-section">
                    <h3><i class="fas fa-comments"></i> 评论</h3>
                    <script src="https://giscus.app/client.js"
                        data-repo="Geeks-Z/Geeks-Z.github.io"
                        data-repo-id=""
                        data-category="Announcements"
                        data-category-id=""
                        data-mapping="pathname"
                        data-strict="0"
                        data-reactions-enabled="1"
                        data-emit-metadata="0"
                        data-input-position="bottom"
                        data-theme="preferred_color_scheme"
                        data-lang="zh-CN"
                        crossorigin="anonymous"
                        async>
                    </script>
                </section>
            </article>

            <footer class="post-footer">
                <p>© 2025 Hongwei Zhao. Built with ❤️</p>
            </footer>
        </main>
    </div>

    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
        <i class="fas fa-moon"></i>
    </button>

    <script>
        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        const icon = themeToggle.querySelector('i');
        const hljsDark = document.getElementById('hljs-theme-dark');
        const hljsLight = document.getElementById('hljs-theme-light');
        
        // Check saved theme or system preference
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
            html.setAttribute('data-theme', 'dark');
            icon.className = 'fas fa-sun';
            hljsDark.disabled = false;
            hljsLight.disabled = true;
        }
        
        themeToggle.addEventListener('click', () => {
            const isDark = html.getAttribute('data-theme') === 'dark';
            if (isDark) {
                html.removeAttribute('data-theme');
                icon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'light');
                hljsDark.disabled = true;
                hljsLight.disabled = false;
            } else {
                html.setAttribute('data-theme', 'dark');
                icon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'dark');
                hljsDark.disabled = false;
                hljsLight.disabled = true;
            }
            
            // Update Giscus theme
            const giscusFrame = document.querySelector('iframe.giscus-frame');
            if (giscusFrame) {
                giscusFrame.contentWindow.postMessage({
                    giscus: {
                        setConfig: {
                            theme: isDark ? 'light' : 'dark'
                        }
                    }
                }, 'https://giscus.app');
            }
        });
        
        // Highlight.js
        document.addEventListener('DOMContentLoaded', () => {
            hljs.highlightAll();
        });
        
        // KaTeX auto-render
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof renderMathInElement !== 'undefined') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\[', right: '\\]', display: true},
                        {left: '\\(', right: '\\)', display: false}
                    ],
                    throwOnError: false
                });
            }
        });
        
        // TOC active state
        const tocLinks = document.querySelectorAll('.toc-container a');
        const headings = document.querySelectorAll('.post-content h2, .post-content h3, .post-content h4');
        
        function updateTocActive() {
            let current = '';
            headings.forEach(heading => {
                const rect = heading.getBoundingClientRect();
                if (rect.top <= 100) {
                    current = heading.getAttribute('id');
                }
            });
            
            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        }
        
        window.addEventListener('scroll', updateTocActive);
        updateTocActive();
    </script>
</body>
</html>
